<script>
    $( document ).ready(function() {
         var map  = initializeMap(<%= @trip.origin.latitude %>, <%= @trip.origin.longitude %>);
        displayDirectionsOnMap(map, '<%= @trip.origin.address %>', '<%= @trip.destination.address %>')
    });
</script>

<%- model_class = Trip -%>
<div class="row-fluid">
  <div class='span6'>
    <div>
      <a class="pull-left" href="#">
        <%= image_tag  @trip.user.profile.avatar.url, :class => 'media-object img-circle avatar'%>
      </a>
      &nbsp;
      <h1><%=t '.title', :default => @trip.name %></h1>
    </div>
  </div>

  <div class='span6'>
      <div class='btn-group pull-right'>
        <%= link_to t('.back', :default => t("helpers.links.back")),
                    trips_path, :class => 'btn-primary btn'  %>
        <%= link_to t('.edit', :default => t("helpers.links.edit")),
                    edit_trip_path(@trip), :class => 'btn-primary btn' %>
        <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                    trip_path(@trip),
                    :method => 'delete',
                    :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
                    :class => 'btn btn-warning' %>
      </div>
   </div>
</div>
</br>

<div class="row-fluid">
  <div class='span12'>
    <div class='map-container'>
      <div id='map-canvas'/>
    </div>
  </div>
</div>

<hr/>
<br/><br/>
<div class='row-fluid'>
  <div class='span6'>
    <br/>
        <div class='row-fluid'>
          <div class='span1 trip_details_row'>&nbsp;</div>
          <div class='span1 trip_details_row'>
            <%= fa_icon "map-marker 2x", class: 'trip_address_color'  %>
          </div>
          <div class='span10 trip_details_row'>
            <%= @trip.origin.address %>
            &nbsp;
            <%= fa_icon "chevron-right" %> <%= fa_icon "chevron-right" %> <%= fa_icon "chevron-right" %>
            &nbsp;
            <%= @trip.destination.address %>
          </div>

        </div>
        <div class='row-fluid'>
          <div class='span1 trip_details_row'>&nbsp;</div>
          <div class='span1 trip_details_row'><%= fa_icon "calendar-o 2x", class: 'trip_address_color'  %></div>
          <div class='span10 trip_details_row'><%= @trip.start_datetime.strftime("%m/%d/%y %I:%M %P %Z") %></div>
        </div>
        <div class='row-fluid'>
          <div class='span1 trip_details_row'>&nbsp;</div>
          <div class='span1 trip_details_row'><%= fa_icon "tachometer 2x", class: 'trip_address_color'  %></div>
          <div class='span10 trip_details_row'><%= @trip.transportation %> with <%= @trip.total_seats %> seats (<%= @trip.seats_remaining %> left)</div>
        </div>
        <div class='row-fluid'>
          <div class='span1 trip_details_row'>&nbsp;</div>
          <div class='span1 trip_details_row'><%= fa_icon "gift 2x", class: 'trip_address_color'  %></div>
          <div class='span10 trip_details_row'><%= @trip.compensation %></div>
        </div>
        <div class='row-fluid'>
          <div class='span1 trip_details_row'>&nbsp;</div>
          <div class='span6 trip_details_row'>
            <%= button_to 'Book Now!',
                          trip_bookings_path(@trip),
                          :method => :post,
                          :class => 'btn-primary btn-block' %>

          </div>
        </div>
  </div>
  <div class='span3'>
    <div><h4>Who's along for the ride?</h4></div>
    <table class='table table-striped'>
      <tbody>
      <% @all_bookings.each do |booking| %>
          <tr>
            <td>
              <a class="pull-left" href="#">
                <%= image_tag  @trip.user.profile.avatar.url, :class => 'media-object img-circle avatar-sm'%>
              </a>
            </td>
            <td><%= booking.user.profile.name %></td>
          </tr>
      <% end %>
      </tbody>
    </table>
  </div>
 </div>
 <br/>

<div class='row-fluid'>
    <div class='span12'>
        <div><h3>Comments:</h3></div>
        <br/>
        <table class='table table-striped'>
          <tbody>
             <% @all_comments.each do |comm| %>

                <tr>
                    <td>
                        <div class="media">
                          <a class="pull-left" href="#">
                            <%= image_tag  comm.user.profile.avatar.url, :class => 'media-object img-circle avatar'%>
                          </a>
                          <div class="media-body">
                            <h5 class="media-heading"><%= comm.user.profile.name %> said:</h5>
                            <%= comm.comment.html_safe %>
                          </div>
                        </div>
                    </td>
                </tr>

             <% end %>
          </tbody>
        </table>
  </div>
</div>
<br/>
<div class='row-fluid'>
  <div class='span12'>
        <%= form_for [@trip, @comment]  do |f| %>
            <div class="control-group">
              <%= f.label :comment, :class => 'control-label' %>
              <div class="controls">
                <%= f.text_area :comment, :class => 'text_field comment_field' %>
              </div>
            </div>
            <div class="form-actions">
              <%= f.submit nil, :class => 'btn btn-primary' %>
            </div>
        <% end %>
   </div>
</div>
